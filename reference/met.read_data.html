<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct mSet data container, read metabolomics data, filter data, and impute missing values — met.read_data • VisomX</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Construct mSet data container, read metabolomics data, filter data, and impute missing values — met.read_data"><meta name="description" content="met.read_data is a wrapper function that constructs an mSet object, adds data from a table file or R dataframe object, applies unspecific and user-defined data filters, and imputes missing values."><meta property="og:description" content="met.read_data is a wrapper function that constructs an mSet object, adds data from a table file or R dataframe object, applies unspecific and user-defined data filters, and imputes missing values."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VisomX</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.94</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_proteomics.html">Reliable and extensive analysis of Proteomics data with package `VisomX`</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_transcriptomics.html">Reliable and extensive analysis of transcriptomics data with package `VisomX`</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NicWir/VisomX/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct mSet data container, read metabolomics data, filter data, and impute missing values</h1>
      <small class="dont-index">Source: <a href="https://github.com/NicWir/VisomX/blob/master/R/metabolomics_computation.R" class="external-link"><code>R/metabolomics_computation.R</code></a></small>
      <div class="d-none name"><code>met.read_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>met.read_data</code> is a wrapper function that constructs an mSet object, adds data from a table file or R dataframe object, applies unspecific and user-defined data filters, and imputes missing values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">met.read_data</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  data.type <span class="op">=</span> <span class="st">"conc"</span>,</span>
<span>  anal.type <span class="op">=</span> <span class="st">"stat"</span>,</span>
<span>  paired <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  csvsep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>  dec <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  data.format <span class="op">=</span> <span class="st">"rowu"</span>,</span>
<span>  lbl.type <span class="op">=</span> <span class="st">"disc"</span>,</span>
<span>  filt.feat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,</span>
<span>  filt.smpl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,</span>
<span>  filt.grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,</span>
<span>  filt.method <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  remain.num <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qcFilter <span class="op">=</span> <span class="st">"F"</span>,</span>
<span>  qc.rsd <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  all.rsd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  imp.method <span class="op">=</span> <span class="st">"lod"</span>,</span>
<span>  export <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  img.format <span class="op">=</span> <span class="st">"pdf"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="va">dpi</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Enter name of an R dataframe object or the "path name" (in quotes) of the CSV/TSV/XLS/XLSX/TXT file to read.</p></dd>


<dt id="arg-data-type">data.type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>(Character) The type of data, either "list" (Compound lists), <code>"conc"</code> (Compound concentration data), <code>"specbin"</code> (Binned spectra data), <code>"pktable"</code> (Peak intensity table), <code>"nmrpeak"</code> (NMR peak lists), <code>"mspeak"</code> (MS peak lists), or <code>"msspec"</code> (MS spectra data).</p></dd>


<dt id="arg-anal-type">anal.type<a class="anchor" aria-label="anchor" href="#arg-anal-type"></a></dt>
<dd><p>(Character) Indicate the analysis module to be performed: <code>"stat", "pathora", "pathqea", "msetora", "msetssp", "msetqea", "ts", "cmpdmap", "smpmap",</code> or <code>"pathinteg"</code>.</p></dd>


<dt id="arg-paired">paired<a class="anchor" aria-label="anchor" href="#arg-paired"></a></dt>
<dd><p>(Logical) Indicate if the data is paired (<code>TRUE</code>) or not (<code>FALSE</code>).</p></dd>


<dt id="arg-csvsep">csvsep<a class="anchor" aria-label="anchor" href="#arg-csvsep"></a></dt>
<dd><p>(Character) Enter the separator used in the CSV file (only applicable if reading a ".csv" file).</p></dd>


<dt id="arg-dec">dec<a class="anchor" aria-label="anchor" href="#arg-dec"></a></dt>
<dd><p>(Character) decimal separator used in CSV, TSV and TXT files.</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>(Integer or Character string) Number or name of the sheet with proteomics data in XLS or XLSX files (<em>optional</em>).</p></dd>


<dt id="arg-data-format">data.format<a class="anchor" aria-label="anchor" href="#arg-data-format"></a></dt>
<dd><p>(Character) Specify if samples are paired and in rows (<code>"rowp"</code>), unpaired and in rows (<code>"rowu"</code>), in columns and paired (<code>"colp"</code>), or in columns and unpaired (<code>"colu"</code>).</p></dd>


<dt id="arg-lbl-type">lbl.type<a class="anchor" aria-label="anchor" href="#arg-lbl-type"></a></dt>
<dd><p>(Character) Specify the group label type, either categorical (<code>"disc"</code>) or continuous (<code>"cont"</code>).</p></dd>


<dt id="arg-filt-feat">filt.feat<a class="anchor" aria-label="anchor" href="#arg-filt-feat"></a></dt>
<dd><p>(Character Vector) Enter the names of features to remove from the dataset.</p></dd>


<dt id="arg-filt-smpl">filt.smpl<a class="anchor" aria-label="anchor" href="#arg-filt-smpl"></a></dt>
<dd><p>(Character Vector) Enter the names of samples to remove from the dataset.</p></dd>


<dt id="arg-filt-grp">filt.grp<a class="anchor" aria-label="anchor" href="#arg-filt-grp"></a></dt>
<dd><p>(Character Vector) Enter the names of groups to remove from the dataset.</p></dd>


<dt id="arg-filt-method">filt.method<a class="anchor" aria-label="anchor" href="#arg-filt-method"></a></dt>
<dd><p>(Character) Select an option for unspecific filtering based on the following ranking criteria:</p><ul><li><p><code>"none"</code> apply no unspecific filtering.</p></li>
<li><p><code>"rsd"</code> filters features with low relative standard deviation across the dataset.</p></li>
<li><p><code>"nrsd"</code> is the non-parametric relative standard deviation.</p></li>
<li><p><code>"mean"</code> filters features with low mean intensity value across the dataset.</p></li>
<li><p><code>"median"</code> filters features with low median intensity value across the dataset.</p></li>
<li><p><code>"sd"</code> filters features with low absolute standard deviation across the dataset.</p></li>
<li><p><code>"mad"</code> filters features with low median absolute deviation across the dataset.</p></li>
<li><p><code>"iqr"</code> filters features with a low inter-quartile range across the dataset.</p></li>
</ul></dd>


<dt id="arg-remain-num">remain.num<a class="anchor" aria-label="anchor" href="#arg-remain-num"></a></dt>
<dd><p>(Numerical) Enter the number of variables to keep in your dataset. If <code>NULL</code>, the following empirical rules are applied during data filtering with the methods specified in <code>filter = ""</code>:</p><ul><li><p><strong>Less than 250 variables:</strong> 5% will be filtered</p></li>
<li><p><strong>250 - 500 variables:</strong> 10% will be filtered</p></li>
<li><p><strong>500 - 1000 variables:</strong> 25% will be filtered</p></li>
<li><p><strong>More than 1000 variables:</strong> 40% will be filtered</p></li>
</ul></dd>


<dt id="arg-qcfilter">qcFilter<a class="anchor" aria-label="anchor" href="#arg-qcfilter"></a></dt>
<dd><p>(Logical) Filter the variables based on the relative standard deviation of features in quality control (QC) samples (<code>TRUE</code>), or not (<code>FALSE</code>). This filter can be applied in addition to other, unspecific filtering methods.</p></dd>


<dt id="arg-qc-rsd">qc.rsd<a class="anchor" aria-label="anchor" href="#arg-qc-rsd"></a></dt>
<dd><p>(Numeric) Define the relative standard deviation cut-off in %. Variables with a RSD greater than this number in the QC samples will be removed from the dataset. It is only necessary to specify this argument if <code>qcFilter</code> is <code>TRUE</code>. Otherwise, it will be ignored.</p></dd>


<dt id="arg-all-rsd">all.rsd<a class="anchor" aria-label="anchor" href="#arg-all-rsd"></a></dt>
<dd><p>(Numeric or <code>NULL</code>) Apply a filter based on the in-group relative standard deviation (RSD, in %) or not <code>NULL</code>. Therefore, the RSD of every feature is calculated for every group in the dataset. If the RSD of a variable in any group exceeds the indicated threshold, it is removed from the dataset. This filter can be applied in addition to other filtering methods and is especially useful to perform on data with technical replicates.</p></dd>


<dt id="arg-imp-method">imp.method<a class="anchor" aria-label="anchor" href="#arg-imp-method"></a></dt>
<dd><p>(Character) Select the option to replace missing variables:</p><ul><li><p><code>"lod"</code> replaces missing values with 1/5 of the minimum value for the respective variable.</p></li>
<li><p><code>"rowmin"</code> replaces missing values with the half sample minimum.</p></li>
<li><p><code>"colmin"</code> replaces missing values with the half feature minimum.</p></li>
<li><p><code>"mean"</code> replaces missing values with the mean value of the respective feature column.</p></li>
<li><p><code>"median"</code> replaces missing values with the median value of the respective feature column.</p></li>
<li><p><code>"knn_var"</code> imputes missing values by finding the features in the training set “closest” to it and averages these nearby points to fill in the value.</p></li>
<li><p><code>"knn_smp"</code> imputes missing values by finding the samples in the training set “closest” to it and averages these nearby points to fill in the value.</p></li>
<li><p><code>"bpca"</code> applies Bayesian PCA to impute missing values.</p></li>
<li><p><code>"ppca"</code> applies probabilistic PCA to impute missing values.</p></li>
<li><p><code>"svdImpute"</code> applies singular value decomposition to impute missing values.</p></li>
</ul></dd>


<dt id="arg-export">export<a class="anchor" aria-label="anchor" href="#arg-export"></a></dt>
<dd><p>(Logical, <code>TRUE</code> or <code>FALSE</code>) Shall the missing value detection plots be exported as PDF or PNG file?</p></dd>


<dt id="arg-img-format">img.format<a class="anchor" aria-label="anchor" href="#arg-img-format"></a></dt>
<dd><p>(Character, <code>"png"</code> or <code>"pdf"</code>) image file format (if <code>export = TRUE</code>).</p></dd>


<dt id="arg-dpi">dpi<a class="anchor" aria-label="anchor" href="#arg-dpi"></a></dt>
<dd><p>(Numeric) The resolution of exported PNG and PDF images.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An mSet object with (built in ascending order):</p><ul><li><p>original data at <code>mSetObj$dataSet$data_orig</code>.</p></li>
<li><p>data with manually filtered out features/samples/groups at <code>mSetObj$dataSet$edit</code>.</p></li>
<li><p>data with unspecifically filtered data at  <code>mSetObj$dataSet$filt</code>.</p></li>
<li><p>data with imputed missing values at <code>mSetObj$dataSet$data_proc</code>.</p></li>
<li><p>missing value heatmap at <code>mSetObj$imgSet$missval_heatmap.plot</code> (see <code><a href="met.plot_missval.html">met.plot_missval</a></code>).</p></li>
<li><p>Density and CumSum plots of intensities of proteins with and without missing values at <code>mSetObj$imgSet$missval_density.plot</code> (see <code><a href="met.plot_detect.html">met.plot_detect</a></code>).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicolas T. Wirth <a href="mailto:mail.nicowirth@gmail.com">mail.nicowirth@gmail.com</a>
Technical University of Denmark
License: GNU GPL (&gt;= 2)</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas T. Wirth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

